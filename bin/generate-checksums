#!/bin/sh

set -e
set -u

target=target/hugo-${HUGO_VERSION}-checksums-${CHECKSUM_ALG}.txt

mkdir -p target

test ! -e $target || rm $target

for f in $(ls checksums/*.${CHECKSUM_ALG}); do
    filename=$(basename $f | sed "s:\.${CHECKSUM_ALG}$::")
    digest=$(cat $f)

    echo "$digest  $filename" >> $target 
done

if [ "${GITHUB_ENV:-}" != "" ]; then
    echo "TARGET_CHECKSUMS=$target" >> $GITHUB_ENV
fi