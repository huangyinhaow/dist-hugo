#!/bin/sh

set -e
set -u

# Load from vars folder
for var in $(ls vars); do
    if [ "${GITHUB_ENV:-}" != "" ]; then
        echo "$var=$(cat vars/$var)" >> $GITHUB_ENV
    else 
        echo "$var=$(cat vars/$var)"
    fi    
done

# Load environment variables starting with "LOAD_"
for load in $(env | sort | grep "^LOAD_"); do
    load=$(echo $load | sed "s:^LOAD_::")

    if [ "${GITHUB_ENV:-}" != "" ]; then
        echo "$load" >> $GITHUB_ENV
    else 
        echo "$load"
    fi    
done
